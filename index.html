<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <link rel="stylesheet" href="src/styles/swiper.css" />
    <link rel="stylesheet" href="src/styles/card.css" />
    <link rel="stylesheet" href="src/styles/utils.css" />

    <title>Home</title>
  </head>
  <body class="container my-5 d-flex flex-column gap-4">
    <header class="d-flex justify-content-between">
      <a href="index.html"><img id="logo" src="assets/logo.svg" alt="logo" /></a>

      <div id="sign_btns">
        <a href="login.html" id="btn-login" class="btn btn-outline-primary">Entrar</a>
        <a href="cadastro.html" id="btn-register" class="btn btn-outline-primary">Registrar-se</a>
      </div>

      <div id="signed_dd" class="dropdown" hidden>
        <button
          class="btn btn-outline-primary dropdown-toggle"
          type="button"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          Ol√°, <span id="dd_username">_</span>!
        </button>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="#meu-perfil">Meu Perfil</a></li>
          <li><a class="dropdown-item" href="meusIngressos.html">Meus Ingressos</a></li>
          <li><span style="cursor: pointer;" id="signout" class="dropdown-item">Sair</span></li>
        </ul>
      </div>
    </header>

    <main class="d-flex flex-column gap-3">
      <form action="" method="get" id="search-form" class="input-group flex-nowrap align-self-center">
        <label for="search-bar" id="addon-wrapping" class="input-group-text">Buscar</label>
        <input
          type="search"
          name="q"
          placeholder="Eventos, shows, festivais, ..."
          id="search-bar"
          class="form-control"
          aria-label="Pesquisar eventos, shows, festivais, ..."
          aria-describedby="addon-wrapping"
        />
        <button type="submit" id="search-button" class="btn btn-outline-secondary" aria-label="Pesquisar">
          <i class="bi bi-search"></i>
        </button>
      </form>

      <section id="highlights">
        <a href="#highlights">
          <h2>Destaques</h2>
        </a>

        <div class="swiper" id="highlights-swiper">
          <div class="swiper-pagination" id="highlights-swiper-pagination"></div>
        </div>
      </section>

      <section id="events">
        <a href="#events">
          <h2>Eventos</h2>
        </a>

        <div class="swiper minor-swiper" id="events-swiper">
          <div class="swiper-pagination" id="events-swiper-pagination"></div>
        </div>
      </section>

      <section id="shows">
        <a href="#shows">
          <h2>Shows</h2>
        </a>

        <div class="swiper minor-swiper" id="shows-swiper">
          <div class="swiper-pagination" id="shows-swiper-pagination"></div>
        </div>
      </section>

      <section id="festivals">
        <a href="#festivals">
          <h2>Festivais</h2>
        </a>

        <div class="swiper minor-swiper" id="festivals-swiper">
          <div class="swiper-pagination" id="festivals-swiper-pagination"></div>
        </div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-element-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="src/index.js" type="module"></script>
    <script src="src/libs/jwt-decode.js"></script>
    <script>
      const token = window.localStorage.getItem('tktkn')
      const signOutBtn = document.getElementById('signout')

      signOutBtn.addEventListener('click', (ev) => {
        window.localStorage.removeItem('tktkn')
        window.location.reload()
      })

      if (token) {
        const tokenContent = jwt_decode(token)
        document.getElementById('dd_username').innerHTML = tokenContent.name.split(' ')[0]

        document.getElementById('sign_btns').setAttribute('hidden', 'true')
        document.getElementById('signed_dd').removeAttribute('hidden')
      }
    </script>
  </body>
</html>